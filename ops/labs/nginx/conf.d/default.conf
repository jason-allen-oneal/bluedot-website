# Nginx inside the labs-proxy container.
# This listens on port 80 *inside* the container.

server {
  listen 80;
  server_name _;

  # Basic hardening
  add_header X-Content-Type-Options nosniff always;
  add_header X-Frame-Options SAMEORIGIN always;
  add_header Referrer-Policy strict-origin-when-cross-origin always;

  # Labs index (static)
  location = / {
    root /usr/share/nginx/html;
    try_files /index.html =404;
  }

  location /assets/ {
    root /usr/share/nginx/html;
    try_files $uri =404;
  }

  # Health check
  location = /_health {
    return 200 'ok';
    add_header Content-Type text/plain;
  }

  # ---- Demo routes ----
  include /etc/nginx/conf.d/routes.conf;
}
